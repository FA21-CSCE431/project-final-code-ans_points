<!DOCTYPE html>
<html lang="en">
  <head>
      <title>ANS Points</title>
      <%= csrf_meta_tags %>
      <%= csp_meta_tag %>
      <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
      <%= javascript_pack_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
  </head>
  <body>
    <div id="events-container" class="container">            
      <h1 class="title">Admin Points Dashboard</h1>
    </div>

    <div class="search-container">
      <input type="text" id="searchTableInput" onkeyup="filterTable()" placeholder="Search emails..">
    </div>

    <div class="table-container">
      <table id="pointsTable" class="table table-responsive table-bordered table-hover table-striped table-md">
        <thead class="table-head">
          <tr>
            <th scope="col" class="table-header" data-field="index" data-align="center" data-sortable="true">#</th>
            <th scope="col" class="table-header" data-field="index" data-align="center" data-sortable="true">Email</th>
            <th scope="col" class="table-header" data-field="id" data-align="center" data-sortable="true">Points</th>
          </tr>
        </thead>
        <tbody>
          <% i = 1 %>
          <% @user_points_counts.each do |data| %>
          <tr>
            <td><%= i %></td>
            <td><%= data.email %></td>
            <td><%= data.count %></td>
          </tr>
          <% i = i + 1 %> 
          <% end %>
        </tbody>
      </table>
    </div>
  
    <script>
    function filterTable() {
      // Declare variables
      var input, filter, table, tr, td, i, txtValue;
      input = document.getElementById("searchTableInput");
      filter = input.value.toUpperCase();
      table = document.getElementById("pointsTable");
      tr = table.getElementsByTagName("tr");

      // Loop through all table rows, and hide those who don't match the search query
      for (i = 0; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[1];
        if (td) {
          txtValue = td.textContent || td.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
          } else {
            tr[i].style.display = "none";
          }
        }
      }
    }
    </script>
  </body>
</html>